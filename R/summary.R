#' Summary function for skim_df
#'
#' This is a method of the generic function [`summary()`].
#'
#' @param object a skim dataframe.
#' @param ... Additional arguments affecting the summary produced. Not used.
#' @return A summary of the skim data frame.
#' @examples
#' \dontrun{
#' a <- skim(mtcars)
#' summary(a)
#' }
#' @export
summary.skim_df <- function(object, ...) {
  if (is.null(object)) {
    stop("dataframe is null.")
  }

  duplicated <- duplicated(object$skim_variable)
  counts <- table(type = object$skim_type[!duplicated])
  type_frequencies <- tibble::as_tibble(counts)
  possible_groups <- attr(object, "groups")

  summary_object <- list(
    df_name = attr(object, "df_name"),
    n_rows = attr(object, "data_rows"),
    n_cols = attr(object, "data_cols"),
    type_frequencies = type_frequencies,
    possible_groups = possible_groups
  )

  summary_object <- structure(summary_object, class = c("summary_skim_df", "list"))
  summary_object
}
